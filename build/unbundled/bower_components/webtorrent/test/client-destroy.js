var Buffer=require("safe-buffer").Buffer,fixtures=require("webtorrent-fixtures"),test=require("tape"),WebTorrent=require("../");test("after client.destroy(), throw on client.add() or client.seed()",function(e){e.plan(3);var r=new WebTorrent({dht:!1,tracker:!1});r.on("error",function(r){e.fail(r)}),r.on("warning",function(r){e.fail(r)}),r.destroy(function(r){e.error(r,"client destroyed")}),e.throws(function(){r.add("magnet:?xt=urn:btih:"+fixtures.leaves.parsedTorrent.infoHash)}),e.throws(function(){r.seed(Buffer.from("sup"))})}),test('after client.destroy(), no "torrent" or "ready" events emitted',function(e){e.plan(1);var r=new WebTorrent({dht:!1,tracker:!1});r.on("error",function(r){e.fail(r)}),r.on("warning",function(r){e.fail(r)}),r.add(fixtures.leaves.torrent,{name:"leaves"},function(){e.fail('unexpected "torrent" event (from add)')}),r.seed(fixtures.leaves.content,{name:"leaves"},function(){e.fail('unexpected "torrent" event (from seed)')}),r.on("ready",function(){e.fail('unexpected "ready" event')}),r.destroy(function(r){e.error(r,"client destroyed")})});