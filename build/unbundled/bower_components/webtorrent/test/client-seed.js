var Buffer=require("safe-buffer").Buffer,fixtures=require("webtorrent-fixtures"),test=require("tape"),WebTorrent=require("../");test("client.seed: torrent file (Buffer)",function(e){e.plan(6);var r=new WebTorrent({dht:!1,tracker:!1});r.on("error",function(r){e.fail(r)}),r.on("warning",function(r){e.fail(r)}),r.seed(fixtures.leaves.content,{name:"Leaves of Grass by Walt Whitman.epub"},function(n){e.equal(r.torrents.length,1),e.equal(n.infoHash,fixtures.leaves.parsedTorrent.infoHash),e.equal(n.magnetURI,fixtures.leaves.magnetURI),r.remove(n,function(r){e.error(r,"torrent removed")}),e.equal(r.torrents.length,0),r.destroy(function(r){e.error(r,"client destroyed")})})}),test("client.seed: torrent file (Buffer), set name on buffer",function(e){e.plan(6);var r=new WebTorrent({dht:!1,tracker:!1});r.on("error",function(r){e.fail(r)}),r.on("warning",function(r){e.fail(r)});var n=Buffer.from(fixtures.leaves.content);n.name="Leaves of Grass by Walt Whitman.epub",r.seed(n,function(n){e.equal(r.torrents.length,1),e.equal(n.infoHash,fixtures.leaves.parsedTorrent.infoHash),e.equal(n.magnetURI,fixtures.leaves.magnetURI),r.remove(n,function(r){e.error(r,"torrent removed")}),e.equal(r.torrents.length,0),r.destroy(function(r){e.error(r,"client destroyed")})})}),test("client.seed: torrent file (Blob)",function(e){if("undefined"==typeof Blob)return e.end();e.plan(6);var r=new WebTorrent({dht:!1,tracker:!1});r.on("error",function(r){e.fail(r)}),r.on("warning",function(r){e.fail(r)}),r.seed(new Blob([fixtures.leaves.content]),{name:"Leaves of Grass by Walt Whitman.epub"},function(n){e.equal(r.torrents.length,1),e.equal(n.infoHash,fixtures.leaves.parsedTorrent.infoHash),e.equal(n.magnetURI,fixtures.leaves.magnetURI),r.remove(n,function(r){e.error(r,"torrent removed")}),e.equal(r.torrents.length,0),r.destroy(function(r){e.error(r,"client destroyed")})})});