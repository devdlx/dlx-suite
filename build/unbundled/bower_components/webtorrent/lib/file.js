function File(e,t){EventEmitter.call(this),this._torrent=e,this._destroyed=!1,this.name=t.name,this.path=t.path,this.length=t.length,this.offset=t.offset,this.done=!1;var r=t.offset,i=r+t.length-1;this._startPiece=r/this._torrent.pieceLength|0,this._endPiece=i/this._torrent.pieceLength|0,0===this.length&&(this.done=!0,this.emit("done"))}module.exports=File;var eos=require("end-of-stream"),EventEmitter=require("events").EventEmitter,FileStream=require("./file-stream"),inherits=require("inherits"),path=require("path"),render=require("render-media"),stream=require("readable-stream"),streamToBlob=require("stream-to-blob"),streamToBlobURL=require("stream-to-blob-url"),streamToBuffer=require("stream-with-known-length-to-buffer");inherits(File,EventEmitter),File.prototype.select=function(e){0!==this.length&&this._torrent.select(this._startPiece,this._endPiece,e)},File.prototype.deselect=function(){0!==this.length&&this._torrent.deselect(this._startPiece,this._endPiece,!1)},File.prototype.createReadStream=function(e){var t=this;if(0===this.length){var r=new stream.PassThrough;return process.nextTick(function(){r.end()}),r}var i=new FileStream(t,e);return t._torrent.select(i._startPiece,i._endPiece,!0,function(){i._notify()}),eos(i,function(){t._destroyed||t._torrent.destroyed||t._torrent.deselect(i._startPiece,i._endPiece,!0)}),i},File.prototype.getBuffer=function(e){streamToBuffer(this.createReadStream(),this.length,e)},File.prototype.getBlob=function(e){if("undefined"==typeof window)throw new Error("browser-only method");streamToBlob(this.createReadStream(),this._getMimeType(),e)},File.prototype.getBlobURL=function(e){if("undefined"==typeof window)throw new Error("browser-only method");streamToBlobURL(this.createReadStream(),this._getMimeType(),e)},File.prototype.appendTo=function(e,t){if("undefined"==typeof window)throw new Error("browser-only method");render.append(this,e,t)},File.prototype.renderTo=function(e,t){if("undefined"==typeof window)throw new Error("browser-only method");render.render(this,e,t)},File.prototype._getMimeType=function(){return render.mime[path.extname(this.name).toLowerCase()]},File.prototype._destroy=function(){this._destroyed=!0,this._torrent=null};